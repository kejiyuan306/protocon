# 接口文档

版本号：0x0001

本套接口规定了终端设备与 ies-con-connector 后端之间所有可用的命令类型。
主要是终端设备向后端定时上传设备当前状态、后端要求修改终端设备的运行状态等命令。

本文档将会对于每个命令，描述其 Type 与 Data 字段。对于 Data 字段的描述即为 Data 中 JSON 对象中出现的键值对类型。视命令的执行成功与否，键值对将会不同。

## JSON 对象命名规范

JSON 对象中的 Key 使用下划线命名法。

## 命令一览

### 统一错误响应

如果`被动方`在执行命令时产生了错误，无法返回正常的响应，它应当将响应中的 Status 字段设为 false，且响应中的 Data 中的键值对应当仅返回错误信息，具体见下表。

| Key     | Value Type | Description                         |
| ------- | ---------- | ----------------------------------- |
| details | string     | Details about the encountered error |

### 命令示例

这里展示一个简单的 Hello World 命令。
该命令仅作为示范，实际不存在。

#### 命令类型

0x0001

#### 请求 Data 格式

| Key  | Value Type | Description        |
| ---- | ---------- | ------------------ |
| name | string     | The name of sender |
| age  | int        | The age of sender  |

#### 响应 Data 格式

| Key     | Value Type | Description           |
| ------- | ---------- | --------------------- |
| message | string     | A Hello World message |

#### 具体例子

`主动方`发送一条如下请求。

```json
{
    "name": "San Zhang",
    "age": 22
}
```

TODO: 展示使用 protocon 协议编码的 HEX 码

`被动方`接收到该请求后，如果命令执行成功返回如下响应

```json
{
    "message": "Hello World, name: `San Zhang`, age: `22`"
}
```

TODO: 展示使用 protocon 协议编码的 HEX 码

如果命令失败，返回如下响应

```json
{
    "details": "Unknown error"
}
```

TODO: 展示使用 protocon 协议编码的 HEX 码

### 客户端供接口

客户端提供的接口，即命令由服务端发起，请求（Request）由服务端发送，操作由客户端完成，响应（Response）由客户端返回。

### 服务端供接口

服务端提供的接口，即客户端发送请求（Request），服务端返回响应（Response）。
